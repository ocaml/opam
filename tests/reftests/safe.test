N0REP0
### OPAMYES=1
### :I: opam log dir and safe mode
### <pin:varos/varos.opam>
opam-version: "2.0"
build: [
  [make "all"]
  [make "test"] {with-test}
]
### <cat-makefile.sh>
f=$1
cat > $f << EOF
all:
	echo \$(shell ${OPAM} var os-version --safe)
	${OPAM} var os-version --safe
	echo done
EOF
### sh cat-makefile.sh varos/Makefile
### opam switch create varos --empty
### # opam install foo bar
### opam pin ./varos -n
[NOTE] Package varos does not exist in opam repositories registered in the current switch.
varos is now pinned to file://${BASEDIR}/varos (version dev)
### opam install varos -v | sed-cmd make

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/1: [varos.dev: rsync]
[varos.dev] synchronised (no changes)

The following actions will be performed:
=== install 1 package
  - install varos dev (pinned)

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/3: [varos.dev: rsync]
-> retrieved varos.dev  (file://${BASEDIR}/varos)
Processing  2/3: [varos: make all]
+ make "all" (CWD=${BASEDIR}/OPAM/varos/.opam-switch/build/varos.dev)
- echo n/a
- n/a
- ${OPAM} var os-version --safe
- n/a
- echo done
- done
-> compiled  varos.dev
-> installed varos.dev
Done.
