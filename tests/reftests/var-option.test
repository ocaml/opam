009e00fa
### opam switch create var-option --empty
### opam var user= --switch var-option
Removed variable user in switch var-option
### opam var group= --switch var-option
Removed variable group in switch var-option
### opam var arch=x86_64 --global
Added '[arch "x86_64" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var jobs=7 --global
Added '[jobs "7" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var make=make --global
Added '[make "make" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var opam-version=68.79 --global
Added '[opam-version "68.79" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var os=linux --global
Added '[os "linux" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var os-distribution=lorem --global
Added '[os-distribution "lorem" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var os-family=ipsum --global
Added '[os-family "ipsum" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var os-version=dolor --global
Added '[os-version "dolor" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var sys-ocaml-arch= --global
Removed variable sys-ocaml-arch in global configuration
### opam var sys-ocaml-cc= --global
Removed variable sys-ocaml-cc in global configuration
### opam var sys-ocaml-libc= --global
Removed variable sys-ocaml-libc in global configuration
### opam option wrap-build-commands=[] --global
Set to '[]' the field wrap-build-commands in global configuration
### opam option wrap-install-commands=[] --global
Set to '[]' the field wrap-install-commands in global configuration
### opam option wrap-remove-commands=[] --global
Set to '[]' the field wrap-remove-commands in global configuration
### opam install ocaml-base-compiler.4.08.0 --fake --yes
The following actions will be faked:
  - install base-bigarray       base
  - install ocaml-base-compiler 4.08.0
  - install base-threads        base
  - install base-unix           base
  - install ocaml-config        1
  - install ocaml               4.08.0
===== 6 to install =====

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Faking installation of base-bigarray.base
Faking installation of base-threads.base
Faking installation of base-unix.base
Faking installation of ocaml-base-compiler.4.08.0
Faking installation of ocaml-config.1
Faking installation of ocaml.4.08.0
Done.
### opam var

<><> Global opam variables ><><><><><><><><><><><><><><><><><><><><><><><><><><>
arch              x86_64                        # Set through 'opam var'
exe                                             # Suffix needed for executable filenames (Windows)
jobs              7                             # Set through 'opam var'
make              make                          # Set through 'opam var'
opam-version      68.79                         # Set through 'opam var'
os                linux                         # Set through 'opam var'
os-distribution   lorem                         # Set through 'opam var'
os-family         ipsum                         # Set through 'opam var'
os-version        dolor                         # Set through 'opam var'
root              ${BASEDIR}/OPAM # The current opam root directory
switch                                          # The identifier of the current switch
sys-ocaml-version 4.08.0                        # Set through 'opam var'

<><> Configuration variables from the current switch ><><><><><><><><><><><><><>
prefix   ${BASEDIR}/OPAM/var-option
lib      ${BASEDIR}/OPAM/var-option/lib
bin      ${BASEDIR}/OPAM/var-option/bin
sbin     ${BASEDIR}/OPAM/var-option/sbin
share    ${BASEDIR}/OPAM/var-option/share
doc      ${BASEDIR}/OPAM/var-option/doc
etc      ${BASEDIR}/OPAM/var-option/etc
man      ${BASEDIR}/OPAM/var-option/man
toplevel ${BASEDIR}/OPAM/var-option/lib/toplevel
stublibs ${BASEDIR}/OPAM/var-option/lib/stublibs

<><> Package variables ('opam var --package PKG' to show) <><><><><><><><><><><>
PKG:name       # Name of the package
PKG:version    # Version of the package
PKG:depends    # Resolved direct dependencies of the package
PKG:installed  # Whether the package is installed
PKG:enable     # Takes the value "enable" or "disable" depending on whether the package is installed
PKG:pinned     # Whether the package is pinned
PKG:bin        # Binary directory for this package
PKG:sbin       # System binary directory for this package
PKG:lib        # Library directory for this package
PKG:man        # Man directory for this package
PKG:doc        # Doc directory for this package
PKG:share      # Share directory for this package
PKG:etc        # Etc directory for this package
PKG:build      # Directory where the package was built
PKG:hash       # Hash of the package archive
PKG:dev        # True if this is a development package
PKG:build-id   # A hash identifying the precise package version with all its dependencies
PKG:opamfile   # Path of the curent opam file
### opam var --switch var-option
prefix   ${BASEDIR}/OPAM/var-option
lib      ${BASEDIR}/OPAM/var-option/lib
bin      ${BASEDIR}/OPAM/var-option/bin
sbin     ${BASEDIR}/OPAM/var-option/sbin
share    ${BASEDIR}/OPAM/var-option/share
doc      ${BASEDIR}/OPAM/var-option/doc
etc      ${BASEDIR}/OPAM/var-option/etc
man      ${BASEDIR}/OPAM/var-option/man
toplevel ${BASEDIR}/OPAM/var-option/lib/toplevel
stublibs ${BASEDIR}/OPAM/var-option/lib/stublibs
### opam var --global
arch              x86_64                        # Set through 'opam var'
exe                                             # Suffix needed for executable filenames (Windows)
jobs              7                             # Set through 'opam var'
make              make                          # Set through 'opam var'
opam-version      68.79                         # Set through 'opam var'
os                linux                         # Set through 'opam var'
os-distribution   lorem                         # Set through 'opam var'
os-family         ipsum                         # Set through 'opam var'
os-version        dolor                         # Set through 'opam var'
root              ${BASEDIR}/OPAM # The current opam root directory
switch                                          # The identifier of the current switch
sys-ocaml-version 4.08.0                        # Set through 'opam var'
### OPAMDEBUG=-1 OPAMDEBUGSECTIONS="GSTATE STATE" opam var bin
GSTATE                          LOAD-GLOBAL-STATE @ ${BASEDIR}/OPAM
${BASEDIR}/OPAM/var-option/bin
### opam var bin --switch var-option
${BASEDIR}/OPAM/var-option/bin
### opam var bin --global
[ERROR] Variable bin not found in global config
### opam var bin=global-bin --global
Added '[bin "global-bin" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var bin=switch-bin --switch var-option
Added 'bin: "switch-bin"' to field variables in switch var-option
### opam var bin
${BASEDIR}/OPAM/var-option/bin
### opam var bin --switch var-option
${BASEDIR}/OPAM/var-option/bin
### opam var bin --global
global-bin
### opam var foo=global-foo --global
Added '[foo "global-foo" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var foo=switch-foo --switch var-option
Added 'foo: "switch-foo"' to field variables in switch var-option
### opam var foo
switch-foo
### opam var foo --switch var-option
switch-foo
### opam var foo --global
global-foo
### opam var ocaml-base-compiler:version
4.08.0
### opam var ocaml-base-compiler:version --switch var-option
4.08.0
### opam var --package ocaml | grep -v build-id | grep -v opamfile
ocaml:name      ocaml                                                                    # Name of the package
ocaml:version   4.08.0                                                                   # Version of the package
ocaml:depends   ocaml-base-compiler.4.08.0 ocaml-config.1                                # Resolved direct dependencies of the package
ocaml:installed true                                                                     # Whether the package is installed
ocaml:enable    enable                                                                   # Takes the value "enable" or "disable" depending on whether the package is installed
ocaml:pinned    false                                                                    # Whether the package is pinned
ocaml:bin       ${BASEDIR}/OPAM/var-option/bin                             # Binary directory for this package
ocaml:sbin      ${BASEDIR}/OPAM/var-option/sbin                            # System binary directory for this package
ocaml:lib       ${BASEDIR}/OPAM/var-option/lib/ocaml                       # Library directory for this package
ocaml:man       ${BASEDIR}/OPAM/var-option/man                             # Man directory for this package
ocaml:doc       ${BASEDIR}/OPAM/var-option/doc/ocaml                       # Doc directory for this package
ocaml:share     ${BASEDIR}/OPAM/var-option/share/ocaml                     # Share directory for this package
ocaml:etc       ${BASEDIR}/OPAM/var-option/etc/ocaml                       # Etc directory for this package
ocaml:build     ${BASEDIR}/OPAM/var-option/.opam-switch/build/ocaml.4.08.0 # Directory where the package was built
ocaml:hash                                                                               # Hash of the package archive
ocaml:dev       false                                                                    # True if this is a development package
### opam option

<><> Global configuration <><><><><><><><><><><><><><><><><><><><><><><><><><><>
best-effort-prefix-criteria    {}
depext                         true
depext-bypass                  {}
depext-cannot-install          false
depext-run-installs            true
download-command               {}
download-jobs                  3
jobs                           {}
post-build-commands            {}
post-install-commands          {}
post-remove-commands           {}
post-session-commands          {}
pre-build-commands             {}
pre-install-commands           {}
pre-remove-commands            {}
pre-session-commands           {}
repository-validation-command  {}
solver                         {}
solver-criteria                {}
solver-fixup-criteria          {}
solver-upgrade-criteria        {}
wrap-build-commands            {}
wrap-install-commands          {}
wrap-remove-commands           {}

<><> Switch configuration (var-option) ><><><><><><><><><><><><><><><><><><><><>
depext-bypass          {}
post-build-commands    {}
post-install-commands  {}
post-remove-commands   {}
post-session-commands  {}
pre-build-commands     {}
pre-install-commands   {}
pre-remove-commands    {}
pre-session-commands   {}
setenv                 {}
synopsis               "var-option"
wrap-build-commands    {}
wrap-install-commands  {}
wrap-remove-commands   {}
### # Check global & switch option setting
### opam option download-jobs
3
### opam option download-jobs --global
3
### opam option download-jobs --switch var-option
[ERROR] Field or section download-jobs not found
### opam option jobs
### opam option jobs --global
### opam option jobs --switch var-option
[ERROR] Field or section jobs not found
### opam option depext-bypass
[]
### opam option depext-bypass --global
[]
### opam option depext-bypass --switch var-option
[]
### opam option synopsis
"var-option"
### opam option 'synopsis="sit amet"'
Set to '"sit amet"' the field synopsis in switch var-option
### opam option synopsis
"sit amet"
### opam option synopsis --switch var-option
"sit amet"
### opam option synopsis --global
[ERROR] Field or section synopsis not found
### opam option synopsis=
Reverted field synopsis in switch var-option
### opam option synopsis
""
### opam option 'synopsis="consectetur adipiscing"' --switch var-option
Set to '"consectetur adipiscing"' the field synopsis in switch var-option
### opam option synopsis
"consectetur adipiscing"
### opam option synopsis= --switch var-option
Reverted field synopsis in switch var-option
### opam option synopsis
""
### opam option download-jobs
3
### opam option download-jobs=10
Set to '10' the field download-jobs in global configuration
### opam option download-jobs
10
### opam option download-jobs --switch var-option
[ERROR] Field or section download-jobs not found
### opam option download-jobs --global
10
### opam option download-jobs=
Reverted field download-jobs in global configuration
### opam option download-jobs
1
### opam option download-jobs=12 --global
Set to '12' the field download-jobs in global configuration
### opam option download-jobs
12
### opam option download-jobs= --global
Reverted field download-jobs in global configuration
### opam option download-jobs
1
### # Check same option name setting through global & switch
### opam option pre-session-commands
[]
### opam option 'pre-session-commands=["elit"]'
Set to '["elit"]' the field pre-session-commands in switch var-option
### opam option pre-session-commands
"elit"
### opam option pre-session-commands --switch var-option
"elit"
### opam option pre-session-commands --global
[]
### opam option pre-session-commands=
Reverted field pre-session-commands in switch var-option
### opam option pre-session-commands
[]
### opam option pre-session-commands --switch var-option
[]
### opam option pre-session-commands --global
[]
### opam option 'pre-session-commands=["sed"]' --switch var-option
Set to '["sed"]' the field pre-session-commands in switch var-option
### opam option pre-session-commands
"sed"
### opam option pre-session-commands --switch var-option
"sed"
### opam option pre-session-commands --global
[]
### opam option pre-session-commands= --switch var-option
Reverted field pre-session-commands in switch var-option
### opam option pre-session-commands
[]
### opam option pre-session-commands --switch var-option
[]
### opam option pre-session-commands --global
[]
### opam option 'pre-session-commands=["do"]' --global
Set to '["do"]' the field pre-session-commands in global configuration
### opam option pre-session-commands
[]
### opam option pre-session-commands --switch var-option
[]
### opam option pre-session-commands --global
"do"
### opam option pre-session-commands= --global
Reverted field pre-session-commands in global configuration
### opam option pre-session-commands
[]
### opam option pre-session-commands --switch var-option
[]
### opam option pre-session-commands --global
[]
### # Check addition & removal on set
### opam option depext-bypass
[]
### opam option 'depext-bypass+=["tempor"]'
Added '["tempor"]' to field depext-bypass in switch var-option
### opam option 'depext-bypass+=["incididunt"]'
Added '["incididunt"]' to field depext-bypass in switch var-option
### opam option depext-bypass
["incididunt" "tempor"]
### opam option 'depext-bypass-=["incididunt"]'
Removed '["incididunt"]' from field depext-bypass in switch var-option
### opam option depext-bypass
["tempor"]
### opam option 'depext-bypass=["incididunt" "tempor"]'
Set to '["incididunt" "tempor"]' the field depext-bypass in switch var-option
### opam option 'depext-bypass-=["tempor"]'
Removed '["tempor"]' from field depext-bypass in switch var-option
### opam option depext-bypass
["incididunt"]
### opam option 'depext-bypass-=["ut"]'
No modification in switch var-option
### opam option depext-bypass
["incididunt"]
### opam option 'depext-bypass-=[]'
No modification in switch var-option
### opam option depext-bypass
["incididunt"]
### opam option depext-bypass=
Reverted field depext-bypass in switch var-option
### opam option 'depext-bypass-=["tempor"]'
No modification in switch var-option
### opam option depext-bypass
[]
### # Check addition & removal on list
### opam option 'setenv+=lorem="labore"'
Added 'lorem="labore"' to field setenv in switch var-option
### opam option 'setenv+=ipsum="dolore"'
Added 'ipsum="dolore"' to field setenv in switch var-option
### opam option setenv
[[ipsum = "dolore"] [lorem = "labore"]]
### opam option 'setenv-=lorem="labore"'
Removed 'lorem="labore"' from field setenv in switch var-option
### opam option setenv
ipsum = "dolore"
### opam option 'setenv=[[lorem="labore"] [ipsum="dolore"]]'
Set to '[[lorem="labore"] [ipsum="dolore"]]' the field setenv in switch var-option
### opam option 'setenv-=lorem="labore"'
Removed 'lorem="labore"' from field setenv in switch var-option
### opam option setenv
ipsum = "dolore"
### opam option 'setenv-=lorem="et"'
No modification in switch var-option
### opam option setenv
ipsum = "dolore"
### opam option setenv=
Reverted field setenv in switch var-option
### opam option 'setenv-=lorem="labore"'
No modification in switch var-option
### opam option setenv
[]
### # Check that eval-variable is removed when a global variable is removed
### opam option global-variables
[[foo "global-foo" "Set through 'opam var'"] [bin "global-bin" "Set through 'opam var'"] [os-version "dolor" "Set through 'opam var'"] [os-family "ipsum" "Set through 'opam var'"] [os-distribution "lorem" "Set through 'opam var'"] [os "linux" "Set through 'opam var'"] [opam-version "68.79" "Set through 'opam var'"] [make "make" "Set through 'opam var'"] [jobs "7" "Set through 'opam var'"] [arch "x86_64" "Set through 'opam var'"] [sys-ocaml-version "4.08.0" "Set through 'opam var'"]]
### opam option 'eval-variables=[dolore ["mania"] "alica"]'
Set to '[dolore ["mania"] "alica"]' the field eval-variables in global configuration
### opam option eval-variables
[dolore ["mania"] "alica"]
### opam var dolore="mania" --global
Added '[dolore "mania" "Set through 'opam var'"]' to field global-variables in global configuration
### opam var dolore= --global
Removed variable dolore in global configuration
### opam option eval-variables
[]
### opam option global-variables
[[foo "global-foo" "Set through 'opam var'"] [bin "global-bin" "Set through 'opam var'"] [os-version "dolor" "Set through 'opam var'"] [os-family "ipsum" "Set through 'opam var'"] [os-distribution "lorem" "Set through 'opam var'"] [os "linux" "Set through 'opam var'"] [opam-version "68.79" "Set through 'opam var'"] [make "make" "Set through 'opam var'"] [jobs "7" "Set through 'opam var'"] [arch "x86_64" "Set through 'opam var'"] [sys-ocaml-version "4.08.0" "Set through 'opam var'"]]
### # Check uniable operations
### opam option 'variables+={esse: "cillum"}'
[ERROR] Field variables can't be directly appended to, use `opam var` instead
### opam option 'invariant="inv"'
[ERROR] Field invariant is not modifiable
### opam option 'jobs+=3'
[ERROR] Field jobs can't be appended
### opam option 'jobs-=3'
[ERROR] Field jobs can't be substracted
### opam option bar
[ERROR] No option named 'bar' found. Use 'opam option [--global]' to list them
### opam option bar --global
[ERROR] Field or section bar not found
### opam option bar --switch var-option
[ERROR] Field or section bar not found
### opam option bar=sit
[ERROR] No option named 'bar' found. Use 'opam option [--global]' to list them
### opam option bar=sit --global
[ERROR] There is no option named 'bar'. The allowed options are:
jobs download-command download-jobs solver-criteria solver-upgrade-criteria solver-fixup-criteria best-effort-prefix-criteria solver global-variables eval-variables repository-validation-command depext depext-run-installs depext-cannot-install depext-bypass pre-build-commands pre-install-commands pre-remove-commands pre-session-commands wrap-build-commands wrap-install-commands wrap-remove-commands post-build-commands post-install-commands post-remove-commands post-session-commands
### opam option bar=sit --switch var-option
[ERROR] There is no option named 'bar'. The allowed options are:
synopsis setenv depext-bypass pre-build-commands pre-install-commands pre-remove-commands pre-session-commands wrap-build-commands wrap-install-commands wrap-remove-commands post-build-commands post-install-commands post-remove-commands post-session-commands variables
